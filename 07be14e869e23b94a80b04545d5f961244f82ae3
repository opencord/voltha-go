{
  "comments": [
    {
      "key": {
        "uuid": "fb451ce1_b131e117",
        "filename": "rw_core/core/device/logical_agent.go",
        "patchSetId": 26
      },
      "lineNbr": 305,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2020-05-13T14:55:13Z",
      "side": 1,
      "message": "Should there be a lock for that specific flow chunk here to prevent changes on that flow during this deletion process?   I saw similar behaviour a few places below.",
      "revId": "07be14e869e23b94a80b04545d5f961244f82ae3",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "093aa73c_9832e5ba",
        "filename": "rw_core/core/device/logical_agent.go",
        "patchSetId": 26
      },
      "lineNbr": 305,
      "author": {
        "id": 1000107
      },
      "writtenOn": "2020-05-13T15:15:05Z",
      "side": 1,
      "message": "From previous discussion, I believe the caller is expected to hold the chunk lock.  \n(Perhaps document this in the function comment, or refactor the usage semantics?)",
      "parentUuid": "fb451ce1_b131e117",
      "revId": "07be14e869e23b94a80b04545d5f961244f82ae3",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e576bd9c_1b87ee20",
        "filename": "rw_core/core/device/logical_agent.go",
        "patchSetId": 26
      },
      "lineNbr": 305,
      "author": {
        "id": 1000218
      },
      "writtenOn": "2020-05-13T18:36:16Z",
      "side": 1,
      "message": "I\u0027m in favor to add some extra comment",
      "parentUuid": "093aa73c_9832e5ba",
      "revId": "07be14e869e23b94a80b04545d5f961244f82ae3",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a83a7556_c6dde270",
        "filename": "rw_core/core/device/logical_agent.go",
        "patchSetId": 26
      },
      "lineNbr": 740,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2020-05-13T14:55:13Z",
      "side": 1,
      "message": "Adding details of which flow cannot be deleted would be useful.  Also, should we stop on the first error or attempt to delete as much as possible and return the error after.",
      "revId": "07be14e869e23b94a80b04545d5f961244f82ae3",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "07e1b5bf_1b01eeef",
        "filename": "rw_core/core/device/logical_agent.go",
        "patchSetId": 26
      },
      "lineNbr": 740,
      "author": {
        "id": 1000218
      },
      "writtenOn": "2020-05-13T18:36:16Z",
      "side": 1,
      "message": "Added detail to some other errors also. I\u0027m not sure about the second part of your comment. If we succeeded to delete the meter and failed to delete some related flows, is that an error or warning? How important is that and how will we repair the failed parts? I have no favor on any choice. If you are clear on that, I can make changes accordingly.",
      "parentUuid": "a83a7556_c6dde270",
      "revId": "07be14e869e23b94a80b04545d5f961244f82ae3",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4981d27f_ee1b5aa1",
        "filename": "rw_core/core/device/logical_agent.go",
        "patchSetId": 26
      },
      "lineNbr": 853,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2020-05-13T14:55:13Z",
      "side": 1,
      "message": "If we have two flow Adds of the same flow (at least same priority and match) in quick succession then if the first one fail while the second one was waiting on the flowchunk.Lock the flowchunk variable could become nil.   However, chances of this scenario happening is low.",
      "revId": "07be14e869e23b94a80b04545d5f961244f82ae3",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "48e78248_97e3f0d7",
        "filename": "rw_core/core/device/logical_agent.go",
        "patchSetId": 26
      },
      "lineNbr": 853,
      "author": {
        "id": 1000107
      },
      "writtenOn": "2020-05-13T15:15:05Z",
      "side": 1,
      "message": "The flowChunk variable won\u0027t become nil, but the second caller could end up with an instance of flowChunk that is no longer in the map.\n\nI was thinking this could be solved by having a \"deleted\" boolean in each chunk, to be checked (and possibly trigger a map lookup retry) after acquiring the lock.\n\nDoes seem like a very rare case, not sure it needs to be in this patch.",
      "parentUuid": "4981d27f_ee1b5aa1",
      "revId": "07be14e869e23b94a80b04545d5f961244f82ae3",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0cefbf7f_2b546ec9",
        "filename": "rw_core/core/device/logical_agent.go",
        "patchSetId": 26
      },
      "lineNbr": 853,
      "author": {
        "id": 1000218
      },
      "writtenOn": "2020-05-13T18:36:16Z",
      "side": 1,
      "message": "Agree with Kent.",
      "parentUuid": "48e78248_97e3f0d7",
      "revId": "07be14e869e23b94a80b04545d5f961244f82ae3",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "359a4d84_315e1773",
        "filename": "rw_core/core/device/logical_agent.go",
        "patchSetId": 26
      },
      "lineNbr": 2044,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2020-05-13T14:55:13Z",
      "side": 1,
      "message": "Don\u0027t need groupCount as can use len(agent.groups) in logging below.",
      "revId": "07be14e869e23b94a80b04545d5f961244f82ae3",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4199897e_9a835a67",
        "filename": "rw_core/core/device/logical_agent.go",
        "patchSetId": 26
      },
      "lineNbr": 2044,
      "author": {
        "id": 1000218
      },
      "writtenOn": "2020-05-13T18:36:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "359a4d84_315e1773",
      "revId": "07be14e869e23b94a80b04545d5f961244f82ae3",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388",
      "unresolved": false
    }
  ]
}